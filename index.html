<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title></title>
  <style>
:root{
  --bg:#000;
  --fg:#00ff66;
}
*{box-sizing:border-box;margin:0;padding:0}
html,body,#app{height:100%}
body{
  background:var(--bg);
  color:var(--fg);
  font-family: "Courier New", Courier, monospace;
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
  display:flex;
  align-items:center;
  justify-content:center;
  height:100vh;
}
.wrap{
  width:100%;
  max-width:820px;
  padding:20px;
  text-align:center;
}
#prompt{
  color:var(--fg);
  font-size:20px;
  letter-spacing:2px;
  text-transform:none;
  background:transparent;
  line-height:1.3;
  margin-bottom:18px;
  word-break:break-word;
  filter:contrast(120%) saturate(120%);
  -webkit-font-smoothing:antialiased;
  text-shadow:
    0 0 0.5px rgba(0,255,102,0.9),
    0 0 12px rgba(0,255,102,0.04);
}
form{
  display:flex;
  gap:8px;
  justify-content:center;
  align-items:center;
}
input[type="text"]{
  background:transparent;
  border:2px solid rgba(0,255,102,0.25);
  color:var(--fg);
  padding:10px 12px;
  font-size:18px;
  min-width:160px;
  border-radius:6px;
  outline:none;
  caret-color:var(--fg);
}
input[type="text"]::placeholder{color:rgba(0,255,102,0.25)}
button{
  background:transparent;
  border:2px solid rgba(0,255,102,0.35);
  color:var(--fg);
  padding:10px 12px;
  font-size:16px;
  border-radius:6px;
}
#response{
  margin-top:20px;
  font-size:18px;
  min-height:28px;
  opacity:0;
  transition:opacity .18s ease;
}
.show{opacity:1}
@media (max-width:420px){
  #prompt{font-size:16px}
  input[type="text"]{font-size:16px;min-width:130px;padding:10px}
  button{font-size:14px;padding:10px}
}
  </style>
</head>
<body>
  <main id="app">
    <div class="wrap">
      <div id="prompt">How long until he will be happy?</div>
      <form id="answerForm" autocomplete="off">
        <input id="answer" type="text" inputmode="text" placeholder="" aria-label="answer" />
        <button id="submitBtn" type="submit">Submit</button>
      </form>
      <div id="response" aria-live="polite"></div>
    </div>
  </main>
  <script>
const form = document.getElementById('answerForm');
const input = document.getElementById('answer');
const response = document.getElementById('response');

function normalize(s){ return (s||'').toLowerCase().trim(); }

function parseDuration(s){
  // finds first occurrence of number + unit
  const regex = /([\d,.+-]+)\s*(seconds?|secs?|minutes?|mins?|hours?|hrs?|days?|day|months?|month|years?|yrs?|yr)/i;
  const m = s.match(regex);
  if(!m) return null;
  let n = parseFloat(m[1].replace(/,/g,''));
  const unit = m[2].toLowerCase();
  // convert to days for comparison
  let days = 0;
  if(/sec|second/.test(unit)) days = n/86400;
  else if(/min|minute/.test(unit)) days = n/1440;
  else if(/hour|hr/.test(unit)) days = n/24;
  else if(/month/.test(unit)) days = n*30;
  else if(/day/.test(unit)) days = n;
  else if(/year|yr/.test(unit)) days = n*365;
  return {n,unit,days};
}

function specialFiveYears(s){
  // match explicit "5 year" or "about 5 years" or "around 5 years"
  return /\b(?:about|around|~)?\s*5\s*(?:years|year|yrs|yrs\.)\b/i.test(s) || /\b5-year\b/i.test(s);
}

form.addEventListener('submit', e=>{
  e.preventDefault();
  const raw = input.value || '';
  const s = normalize(raw);
  // remove form controls
  input.disabled = true;
  form.querySelector('button').disabled = true;
  input.style.display = 'none';
  form.querySelector('button').style.display = 'none';

  let msg = '...';

  // Quick-empty check
  if(s === ''){
    msg = "Silence is an answer.";
  } else {
    // Keyword flags
    const hasWater = s.includes('water');
    const hasMike = s.includes('mike');
    const hasIceCream = s.includes('ice cream cone') || s.includes('icecream cone') || s.includes('ice-cream cone') || s.includes('ice cream');
    const hasTerminal = s.includes('terminal');
    const hasAlone = /\balone\b/.test(s);
    const hasForever = /\bforever\b/.test(s);
    const hasSoon = /\bsoon\b/.test(s);
    const hasMonths = /\bmonths?\b/.test(s);
    const hasNever = /\bnever\b/.test(s);
    const hasMaybe = /\bmaybe\b|\bperhaps\b|\bpossibly\b/.test(s);
    const hasHeWont = /\bhe\s*(?:won't|won t|wont|will not|willn't|won\W*t)\b/i.test(raw);
    const isJune11 = /\b(june\s*11|jun\s*11|6[\/\-]11|11 june|11 jun)\b/i.test(raw);

    // numeric special codes anywhere
    const has2763 = /\b2763\b/.test(raw);
    const has1338 = /\b1338\b/.test(raw);

    // not applicable checks
    const hasNotApplicable = /\bnot applicable\b|\bn\/a\b/i.test(raw);

    // uncommon/rare triggers (added)
    const hasFortyTwo = /\b42\b/.test(raw);
    const hasEntropy = /\bentropy\b/.test(s);
    const hasEclipse = /\beclipse\b/.test(s);
    const hasPenguin = /\bpenguin\b/.test(s);
    const hasPiano = /\bpiano\b/.test(s);
    const hasNull = /\bnull\b|\bnone\b|\bvoid\b/.test(s);
    const hasOcarina = /\bocarina\b/.test(s);
    const hasMercury = /\bmercury\b/.test(s);
    const hasSpleen = /\bspleen\b/.test(s);
    const hasEmojiOnly = /^[\u{1F300}-\u{1F6FF}\u{1F900}-\u{1F9FF}\u{2600}-\u{26FF}\s]+$/u.test(raw);

    // character keyword map
    const charMap = new Map([
      ['liver', "He has his own struggles already."],
      ['match', "He cared so much about her, only to be abandoned."],
      ['beach ball', "Was she ever important?"],
      ['hearty', "Was she ever important?"],
      ['crt', "Was she ever important?"],
      ['tomato', "Was she ever important?"],
      ['spade', "Was she ever important?"],
      ['love letter', "Was she ever important?"],
      ['ice cube', "Was she ever important?"],
      ['cosmic gemstone', "Aw..."],
      ['diamond', "Aw..."],
      ['thinker', "Get out of my head."],
      ['luca', "Get out of my head."],
      ['box', "Was he ever important?"],
      ['cheese', "Was he ever important?"],
      ['furry jr', "Was he ever important?"],
      ['furry junior', "Was he ever important?"],
      ['potato', "Was he ever important?"],
      ['muffin', "Was he ever important?"],
      ['bushy', "Out of all people?"],
      ['cloudy', "The one without legs cannot walk."],
      ['furry', "The one without legs cannot walk."],
      ['furball', "The one without legs cannot walk."],
      ['shiny cake', "What are you getting at?"],
      ['daily', "What are you getting at?"],
      ['existy', "What are you getting at?"],
      ['olive', "Noted."]
    ]);

    // Combined special cases
    if(has2763 || has1338){
      msg = "Don't preach to the choir.";
    } else if(hasNotApplicable){
      msg = "You sure?";
    } else {
      // quick uncommon replies before the normal charMap to catch odd inputs
      if(hasFortyTwo){
        msg = "Accept it.";
      } else if(hasEntropy){
        msg = "Things fall apart.";
      } else if(hasEclipse){
        msg = "A brief darkness.";
      } else if(hasPenguin){
        msg = "Cute diversion.";
      } else if(hasPiano){
        msg = "Melody helps.";
      } else if(hasNull){
        msg = "Void.";
      } else if(hasOcarina){
        msg = "Unexpected song.";
      } else if(hasMercury){
        msg = "Mercurial answer.";
      } else if(hasSpleen){
        msg = "An odd feeling.";
      } else if(hasEmojiOnly){
        msg = "Icons don't tell the whole story.";
      } else {
        // character-specific exact phrase checks (prefer longer phrases)
        // detect one or more character keywords and combine responses if multiple found
        const matchedResponses = [];
        const matchedKeys = [];
        for(const [k,v] of charMap){
          if(s.includes(k)){
            matchedResponses.push(v);
            matchedKeys.push(k);
          }
        }

        // custom combined replies for specific multi-character inputs
        const comboMap = new Map([
          // keys should be lowercased and sorted joined by ' + '
          ['beach ball + cosmic gemstone', "A fleeting memory meets something precious; bittersweet."],
          ['beach ball + diamond', "Playful light meets lasting weight."],
          ['cosmic gemstone + diamond', "Both precious; one comforts, one wounds."],
          ['liver + match', "A painful juxtaposition; he carries both."],
          ['box + cheese', "A forgotten container with stale comforts."]
          // add more combos as needed
        ]);

        if(matchedKeys.length === 1){
          msg = matchedResponses[0];
        } else if(matchedKeys.length > 1){
          // try exact combo match using sorted keys for deterministic lookup
          const sortedKey = matchedKeys.map(k=>k.toLowerCase()).sort().join(' + ');
          if(comboMap.has(sortedKey)){
            msg = comboMap.get(sortedKey);
          } else {
            // combine distinct responses, keep order and dedupe
            const dedup = Array.from(new Set(matchedResponses));
            msg = dedup.join(' | ');
          }
        } else if( (hasWater) && (hasMike || hasIceCream) ){
          msg = "Do you believe they're still relevant?";
        } else if(hasWater || hasMike || hasIceCream){
          msg = "She isn't important anymore. Move on.";
        } else if(hasTerminal){
          msg = "She isn't important, but still relevant.";
        } else if(hasHeWont){
          msg = "Do you really read him that way?";
        } else if(isJune11){
          msg = "The day it all went wrong would not be the day he would be happy again.";
        } else if(specialFiveYears(raw)){
          msg = "Too long.";
        } else if(hasForever || hasNever){
          msg = "Never.";
        } else if(hasAlone){
          msg = "He needs company.";
        } else if(hasSoon){
          msg = "Patience.";
        } else if(hasMaybe){
          msg = "Uncertain.";
        } else {
          // try parsing duration
          const dur = parseDuration(raw);
          if(dur){
            // negative duration handling
            if(typeof dur.n === 'number' && dur.n < 0 || (dur.days && dur.days < 0)){
              msg = "The past doesn't matter.";
            } else if(/\b365\s*days?\b/.test(raw) || /\b1\s*year\b/.test(raw) || /\b12\s*months?\b/.test(raw) || Math.abs(dur.days - 365) < 0.0001){
              msg = "He suffered for that same amount of time.";
            } else if(dur.days >= 365){
              // handle multi-year specific messages (2-5 years)
              const years = dur.days / 365;
              // check for approximate integer matches like "2 years", "3 years", etc.
              const yearMatch = raw.match(/\b(\d+(?:\.\d+)?)\s*(?:years|year|yrs|yrs\.)\b/i);
              const approxYears = yearMatch ? parseFloat(yearMatch[1]) : Math.round(years);
              if(Math.abs(years - 2) < 0.1 || approxYears === 2){
                msg = "Unresolved and persistent.";
              } else if(Math.abs(years - 3) < 0.1 || approxYears === 3){
                msg = "The wound still lingers.";
              } else if(Math.abs(years - 4) < 0.1 || approxYears === 4){
                msg = "It has become part of him.";
              } else if(Math.abs(years - 5) < 0.1 || approxYears === 5){
                msg = "Too long.";
              } else {
                msg = "Too long.";
              }
            } else if(dur.days <= 7 && dur.days > 0){
              msg = "Too short.";
            } else if(dur.days > 7 && dur.days < 365){
              // add nuance for months
              if(dur.days >= 30 && dur.days < 120){
                msg = "Close enough.";
              } else if(hasMonths && dur.days < 30){
                msg = "That's too soon.";
              } else {
                msg = "Close enough.";
              }
            } else {
              msg = "...";
            }
          } else {
            // fallback keyword: numbers (e.g., "5", "10 years" without unit parsed)
            const numOnly = raw.match(/\b-?\d{1,4}\b/);
            if(numOnly){
              const val = parseInt(numOnly[0],10);
              if(val < 0) msg = "The past doesn't matter.";
              else if(val === 0) msg = "Already";
              else if(val <= 7) msg = "Too short.";
              else if(val > 7 && val < 365) msg = "Close enough.";
              else if(val === 365 || val === 1) msg = "He suffered for that same amount of time.";
              else if(val === 2763 || val === 1338) msg = "Don't preach to the choir.";
              else msg = "Too long.";
            } else {
              msg = "...";
            }
          }
        }
      }
    }
  }

  response.textContent = msg;
  response.classList.add('show');
  // ensure visibility for environments where the CSS transition/opacity might be skipped
  response.style.opacity = '1';
});
  </script>
</body>
</html>
